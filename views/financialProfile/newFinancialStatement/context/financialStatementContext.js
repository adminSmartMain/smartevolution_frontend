import { createContext, useContext, useReducer, useState } from "react";

const FinancialStatementContext = createContext();

const initialState = {
  data: [
    {
      period: 2022,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 15000000,
        clients_wallet: 9000000,
        cxc_partners: 220000,
        other_cxc: 340000,
        net_cxc: 9560000,
        raw_material_and_others: 1220000,
        products_finished: 740000,
        total_inventory: 1960000,
        advances_and_progress: 450000,
        current_assets: 26970000,
        lands_and_buildings: 14000000,
        m_and_e_vehicles: 4500000,
        gross_fixed_assets: 18500000,
        dep_acum: 840000,
        net_fixed_assets: 17660000,
        difer_intang_leasing: 493800,
        investments_and_others: 590000,
        total_other_assets: 1083800,
        total_assets: 45713800,
      },
      passives: {
        financial_obligation_cp: 350000,
        providers: 7000000,
        unpaid_expenses: 6000000,
        unpaid_taxes: 1250000,
        linked_economics: 60000,
        estimated_passives: 200000,
        current_liabilities: 14860000,
        financial_obligation_lp: 560000,
        other_lp_leasing: 220000,
        lp_passives: 780000,
        total_passives: 15640000,
      },
      patrimony: {
        payed_capital: 7000000,
        sup_capital_prima: 15000000,
        legal_reserve: 2000000,
        periods_results: 2500000,
        accumulated_results: 8000000,
        rev_patrimony_niif: 3000000,
        total_patrimony: 37500000,
        passive_and_patrimony: 53140000,
        total_assets_passives: 7426200,
      },
      stateOfResult: {
        gross_sale: 20000000,
        dtos_returns: 10000000,
        net_sales: 10000000,
        cost_of_sales: 2000000,
        gross_profit: 8000000,
        administrative_expenses_sales: 3000000,
        dep_amortization: 200000,
        operating_profit: 4800000,
        financial_income: 25000000,
        other_incomes: 2000000,
        financial_expenses: 4000000,
        other_expenditures: 300000,
        income_before_taxes: 27500000,
        provision_for_taxes: 4000000,
        net_income: 23500000,
      },
    },
    {
      period: 2023,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 22000000,
        clients_wallet: 10000000,
        cxc_partners: 350000,
        other_cxc: 500000,
        net_cxc: 10850000,
        raw_material_and_others: 1500000,
        products_finished: 2000000,
        total_inventory: 3500000,
        advances_and_progress: 750000,
        current_assets: 37100000,
        lands_and_buildings: 19000000,
        m_and_e_vehicles: 9000000,
        gross_fixed_assets: 28000000,
        dep_acum: 2000000,
        net_fixed_assets: 26000000,
        difer_intang_leasing: 500000,
        investments_and_others: 600000,
        total_other_assets: 1100000,
        total_assets: 64200000,
      },
      passives: {
        financial_obligation_cp: 550000,
        providers: 12000000,
        unpaid_expenses: 800000,
        unpaid_taxes: 200000,
        linked_economics: 100000,
        estimated_passives: 200000,
        current_liabilities: 13850000,
        financial_obligation_lp: 700000,
        other_lp_leasing: 250000,
        lp_passives: 950000,
        total_passives: 14800000,
      },
      patrimony: {
        payed_capital: 9000000,
        sup_capital_prima: 20000000,
        legal_reserve: 7000000,
        periods_results: 3000000,
        accumulated_results: 9000000,
        rev_patrimony_niif: 5000000,
        total_patrimony: 53000000,
        passive_and_patrimony: 67800000,
        total_assets_passives: 3600000,
      },
      stateOfResult: {
        gross_sale: 60000000,
        dtos_returns: 12000000,
        net_sales: 48000000,
        cost_of_sales: 2500000,
        gross_profit: 45500000,
        administrative_expenses_sales: 5000000,
        dep_amortization: 4000000,
        operating_profit: 36500000,
        financial_income: 45000000,
        other_incomes: 4000000,
        financial_expenses: 6000000,
        other_expenditures: 500000,
        income_before_taxes: 79000000,
        provision_for_taxes: 8000000,
        net_income: 71000000,
      },
    },
    {
      period: 2023,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 22000000,
        clients_wallet: 10000000,
        cxc_partners: 350000,
        other_cxc: 500000,
        net_cxc: 10850000,
        raw_material_and_others: 1500000,
        products_finished: 2000000,
        total_inventory: 3500000,
        advances_and_progress: 750000,
        current_assets: 37100000,
        lands_and_buildings: 19000000,
        m_and_e_vehicles: 9000000,
        gross_fixed_assets: 28000000,
        dep_acum: 2000000,
        net_fixed_assets: 26000000,
        difer_intang_leasing: 500000,
        investments_and_others: 600000,
        total_other_assets: 1100000,
        total_assets: 64200000,
      },
      passives: {
        financial_obligation_cp: 550000,
        providers: 12000000,
        unpaid_expenses: 800000,
        unpaid_taxes: 200000,
        linked_economics: 100000,
        estimated_passives: 200000,
        current_liabilities: 13850000,
        financial_obligation_lp: 700000,
        other_lp_leasing: 250000,
        lp_passives: 950000,
        total_passives: 14800000,
      },
      patrimony: {
        payed_capital: 9000000,
        sup_capital_prima: 20000000,
        legal_reserve: 7000000,
        periods_results: 3000000,
        accumulated_results: 9000000,
        rev_patrimony_niif: 5000000,
        total_patrimony: 53000000,
        passive_and_patrimony: 67800000,
        total_assets_passives: 3600000,
      },
      stateOfResult: {
        gross_sale: 60000000,
        dtos_returns: 12000000,
        net_sales: 48000000,
        cost_of_sales: 2500000,
        gross_profit: 45500000,
        administrative_expenses_sales: 5000000,
        dep_amortization: 4000000,
        operating_profit: 36500000,
        financial_income: 45000000,
        other_incomes: 4000000,
        financial_expenses: 6000000,
        other_expenditures: 500000,
        income_before_taxes: 79000000,
        provision_for_taxes: 8000000,
        net_income: 71000000,
      },
    },
    {
      period: 2022,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 15000000,
        clients_wallet: 9000000,
        cxc_partners: 220000,
        other_cxc: 340000,
        net_cxc: 9560000,
        raw_material_and_others: 1220000,
        products_finished: 740000,
        total_inventory: 1960000,
        advances_and_progress: 450000,
        current_assets: 26970000,
        lands_and_buildings: 14000000,
        m_and_e_vehicles: 4500000,
        gross_fixed_assets: 18500000,
        dep_acum: 840000,
        net_fixed_assets: 17660000,
        difer_intang_leasing: 493800,
        investments_and_others: 590000,
        total_other_assets: 1083800,
        total_assets: 45713800,
      },
      passives: {
        financial_obligation_cp: 350000,
        providers: 7000000,
        unpaid_expenses: 6000000,
        unpaid_taxes: 1250000,
        linked_economics: 60000,
        estimated_passives: 200000,
        current_liabilities: 14860000,
        financial_obligation_lp: 560000,
        other_lp_leasing: 220000,
        lp_passives: 780000,
        total_passives: 15640000,
      },
      patrimony: {
        payed_capital: 7000000,
        sup_capital_prima: 15000000,
        legal_reserve: 2000000,
        periods_results: 2500000,
        accumulated_results: 8000000,
        rev_patrimony_niif: 3000000,
        total_patrimony: 37500000,
        passive_and_patrimony: 53140000,
        total_assets_passives: 7426200,
      },
      stateOfResult: {
        gross_sale: 20000000,
        dtos_returns: 10000000,
        net_sales: 10000000,
        cost_of_sales: 2000000,
        gross_profit: 8000000,
        administrative_expenses_sales: 3000000,
        dep_amortization: 200000,
        operating_profit: 4800000,
        financial_income: 25000000,
        other_incomes: 2000000,
        financial_expenses: 4000000,
        other_expenditures: 300000,
        income_before_taxes: 27500000,
        provision_for_taxes: 4000000,
        net_income: 23500000,
      },
    },
    {
      period: 2023,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 22000000,
        clients_wallet: 10000000,
        cxc_partners: 350000,
        other_cxc: 500000,
        net_cxc: 10850000,
        raw_material_and_others: 1500000,
        products_finished: 2000000,
        total_inventory: 3500000,
        advances_and_progress: 750000,
        current_assets: 37100000,
        lands_and_buildings: 19000000,
        m_and_e_vehicles: 9000000,
        gross_fixed_assets: 28000000,
        dep_acum: 2000000,
        net_fixed_assets: 26000000,
        difer_intang_leasing: 500000,
        investments_and_others: 600000,
        total_other_assets: 1100000,
        total_assets: 64200000,
      },
      passives: {
        financial_obligation_cp: 550000,
        providers: 12000000,
        unpaid_expenses: 800000,
        unpaid_taxes: 200000,
        linked_economics: 100000,
        estimated_passives: 200000,
        current_liabilities: 13850000,
        financial_obligation_lp: 700000,
        other_lp_leasing: 250000,
        lp_passives: 950000,
        total_passives: 14800000,
      },
      patrimony: {
        payed_capital: 9000000,
        sup_capital_prima: 20000000,
        legal_reserve: 7000000,
        periods_results: 3000000,
        accumulated_results: 9000000,
        rev_patrimony_niif: 5000000,
        total_patrimony: 53000000,
        passive_and_patrimony: 67800000,
        total_assets_passives: 3600000,
      },
      stateOfResult: {
        gross_sale: 60000000,
        dtos_returns: 12000000,
        net_sales: 48000000,
        cost_of_sales: 2500000,
        gross_profit: 45500000,
        administrative_expenses_sales: 5000000,
        dep_amortization: 4000000,
        operating_profit: 36500000,
        financial_income: 45000000,
        other_incomes: 4000000,
        financial_expenses: 6000000,
        other_expenditures: 500000,
        income_before_taxes: 79000000,
        provision_for_taxes: 8000000,
        net_income: 71000000,
      },
    },
    {
      period: 2023,
      typePeriod: "0835dcb5-d6f2-43d7-b7ca-8864119ea05f",
      client: "9238eb1c-2983-49d4-a6c7-fd4bd9d6c7b8",
      balance: "",
      stateOfCashflow: "",
      financialStatementAudit: "",
      managementReport: "",
      certificateOfStockOwnership: "",
      rentDeclaration: "",
      assets: {
        cash_and_investments: 22000000,
        clients_wallet: 10000000,
        cxc_partners: 350000,
        other_cxc: 500000,
        net_cxc: 10850000,
        raw_material_and_others: 1500000,
        products_finished: 2000000,
        total_inventory: 3500000,
        advances_and_progress: 750000,
        current_assets: 37100000,
        lands_and_buildings: 19000000,
        m_and_e_vehicles: 9000000,
        gross_fixed_assets: 28000000,
        dep_acum: 2000000,
        net_fixed_assets: 26000000,
        difer_intang_leasing: 500000,
        investments_and_others: 600000,
        total_other_assets: 1100000,
        total_assets: 64200000,
      },
      passives: {
        financial_obligation_cp: 550000,
        providers: 12000000,
        unpaid_expenses: 800000,
        unpaid_taxes: 200000,
        linked_economics: 100000,
        estimated_passives: 200000,
        current_liabilities: 13850000,
        financial_obligation_lp: 700000,
        other_lp_leasing: 250000,
        lp_passives: 950000,
        total_passives: 14800000,
      },
      patrimony: {
        payed_capital: 9000000,
        sup_capital_prima: 20000000,
        legal_reserve: 7000000,
        periods_results: 3000000,
        accumulated_results: 9000000,
        rev_patrimony_niif: 5000000,
        total_patrimony: 53000000,
        passive_and_patrimony: 67800000,
        total_assets_passives: 3600000,
      },
      stateOfResult: {
        gross_sale: 60000000,
        dtos_returns: 12000000,
        net_sales: 48000000,
        cost_of_sales: 2500000,
        gross_profit: 45500000,
        administrative_expenses_sales: 5000000,
        dep_amortization: 4000000,
        operating_profit: 36500000,
        financial_income: 45000000,
        other_incomes: 4000000,
        financial_expenses: 6000000,
        other_expenditures: 500000,
        income_before_taxes: 79000000,
        provision_for_taxes: 8000000,
        net_income: 71000000,
      },
    },
  ],
  isInputChanged: false,
};

// create a reducer function that change the state of one column of the table
const reducer = (state, action) => {
  switch (action.type) {
    case "UPDATE_INPUT":
      const newState = { ...state };
      const { indexPeriod, inputKey, newValue } = action.payload;
      newState.data[indexPeriod][inputKey] = Number(newValue);
      newState.isInputChanged = true;
      return newState;
    case "DELETE_ALL":
      return { ...state, data: [] };
    default:
      return state;
  }
};

const FinancialStatementProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);

  return (
    <FinancialStatementContext.Provider value={{ state, dispatch }}>
      {children}
    </FinancialStatementContext.Provider>
  );
};

const useFinancialStatement = () => {
  const context = useContext(FinancialStatementContext);
  if (context === undefined) {
    throw new Error(
      "useFinancialStatement must be used within a FinancialStatementProvider"
    );
  }
  return context;
};

export { FinancialStatementProvider, useFinancialStatement };
